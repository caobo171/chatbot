{"ast":null,"code":"import _regeneratorRuntime from \"/media/caobo171/07190f2f-2f0f-48f2-bf9e-e2b5e9484259/project1/angelhack/vti-angelhack/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _toConsumableArray from \"/media/caobo171/07190f2f-2f0f-48f2-bf9e-e2b5e9484259/project1/angelhack/vti-angelhack/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _asyncToGenerator from \"/media/caobo171/07190f2f-2f0f-48f2-bf9e-e2b5e9484259/project1/angelhack/vti-angelhack/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/media/caobo171/07190f2f-2f0f-48f2-bf9e-e2b5e9484259/project1/angelhack/vti-angelhack/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _possibleConstructorReturn from \"/media/caobo171/07190f2f-2f0f-48f2-bf9e-e2b5e9484259/project1/angelhack/vti-angelhack/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/media/caobo171/07190f2f-2f0f-48f2-bf9e-e2b5e9484259/project1/angelhack/vti-angelhack/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/media/caobo171/07190f2f-2f0f-48f2-bf9e-e2b5e9484259/project1/angelhack/vti-angelhack/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport { Container } from 'unstated-x';\nimport axios from 'axios';\nvar SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;\nvar SpeechSynthesis = window.SpeechSynthesis;\nvar SpeechSynthesisUtterance = window.SpeechSynthesisUtterance;\n\nfunction capitalize(s) {\n  var first_char = /\\S/;\n  return s.replace(first_char, function (m) {\n    return m.toUpperCase();\n  });\n}\n\nexport var IMAGE = {\n  'normal': 'https://i.imgur.com/ilmoJsC.png',\n  'hearing': 'https://i.imgur.com/uS0pZYx.png',\n  'thinking': 'https://i.imgur.com/y5Uc9mL.png'\n};\nvar TRIGGER_END = ['kếtthúc', 'thếthôi', 'hếtrồi', 'xongrồi'];\nvar WARNING = ['màyngu', 'bạnngu'];\nvar FAQs = {\n  \"luyện nghe\": {\n    important: [\"nghe\"],\n    sub: [\"cảithiện\", \"nângcao\", \"nâng\", \"luyện\"],\n    responses: [\"Bạn có thể tham khảo những nguồn sau:\", \"https://nghetienganhpro.com/luyen-nghe-mat-goc-tieng-anh/\", \"https://ngocbach.com/category/thu-vien/listenting/\", \"https://www.welevn.com/\"]\n  },\n  \"luyện nói\": {\n    important: [\"nói\"],\n    sub: [\"cảithiện\", \"nângcao\", \"nâng\", \"luyện\", \"thếcòn\"],\n    responses: [\"Bạn đọc thử  nhé :\", \"https://www.youtube.com/user/proworkshop\", \"https://engbreaking.com/\", 'https://ngocbach.com/category/thu-vien/speaking-thu-vien/']\n  },\n  \"luyện đọc\": {\n    important: [\"đọc\"],\n    sub: [\"cảithiện\", \"nângcao\", \"nâng\", \"luyện\", \"thếcòn\"],\n    responses: [\"Bạn có thể tham khảo những nguồn sau:\", \"https://langmaster.edu.vn/10-website-giup-bnaj-luyen-ky-nang-doc-sieu-dang-a15i668.html\", \"https://x3english.com/cach-doc-tieng-anh\"]\n  },\n  \"luyện viết\": {\n    important: [\"viết\"],\n    sub: [\"cảithiện\", \"nângcao\", \"nâng\", \"luyện\", \"thếcòn\"],\n    responses: [\"Bạn có tham khảo mấy trang này nhé:\", \"https://ngocbach.com/category/thu-vien/writing-thu-vien/\", \"https://langmaster.edu.vn/12-loi-khuyen-dat-gia-cho-nguoi-bat-dau-luyen-viet-tieng-anh-a15i951.html\", \"https://jolo.edu.vn/vi/thu-vien/bi-quyet-ielts/luyen-viet-ielts-cho-nguoi-moi-bat-dau.html\"]\n  },\n  \"tự học hay trung tâm\": {\n    important: [\"hay\", \"trungtâm\", \"tựhọc\"],\n    sub: [\"trungtâm\"],\n    responses: [\"Theo mình thì tự học sẽ tốt hơn !!\", \"Nhưng nếu bạn thấy không hợp và không chủ động được thì nên đi học Trung tâm :))) \"]\n  },\n  \"ơi\": {\n    important: [\"ơi\"],\n    sub: [\"bạn\", \"ơi\"],\n    responses: [\"Ơi !!\"]\n  },\n  \"bắt đầu\": {\n    important: [\"bắtđầu\"],\n    sub: [\"từđâu\", \"thếnào\", \"ởđâu\"],\n    responses: [\"Bạn có thể tham khảo những nguồn sau\", \"https://vnexpress.net/giao-duc/sau-loi-khuyen-hoc-tieng-anh-cho-tan-sinh-vien-3275824.html\", \"http://learningeffortlessenglish.com/huong-dan-hoc/307/huong-dan-hoc-effortless-english-ban-tieng-viet-.html\", \"https://engbreaking.com/\"]\n  },\n  'trung bình': {\n    important: [\"học\"],\n    sub: [\"cũngđược\", \"bìnhthường\", \"khôngdốt\", \"tàmtạm\"],\n    responses: [\"M\\xECnh ngh\\u0129 b\\u1EA1n n\\xEAn tham kh\\u1EA3o c\\xE1c ngu\\u1ED3n online\", \"N\\u1EBFu kh\\xF4ng l\\xEAn \\u0111\\u01B0\\u1EE3c th\\xEC h\\xE3y ngh\\u0129 \\u0111\\u1EBFn nh\\u01B0ng trung t\\xE2m uy t\\xEDn nh\\u01B0:\", \"British Council, IELTS Workshop\"]\n  },\n  'học': {\n    important: ['học'],\n    sub: [\"với\", \"thếnào\", \"đượckhông\", \"rasao\"],\n    responses: [\"\\u1EEA ,b\\u1EA1n y\\xEAn t\\xE2m, m\\xECnh s\\u1EBD c\\u1ED1 g\\u1EAFng h\\u1EBFt s\\u1EE9c !! B\\u1EA1n h\\u1ECFi ti\\u1EBFp \\u0111i !!\"]\n  }\n};\nexport var BotContainer =\n/*#__PURE__*/\nfunction (_Container) {\n  _inherits(BotContainer, _Container);\n\n  function BotContainer(props) {\n    var _this;\n\n    _classCallCheck(this, BotContainer);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(BotContainer).call(this, props));\n\n    _this.processing =\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(final_script) {\n        var scriptDeleteSpace, response, dialog, res, finish, keys, i, faq, _i, _i2;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                scriptDeleteSpace = final_script.replace(/\\s/g, \"\").toLocaleLowerCase();\n\n                if (!(scriptDeleteSpace === '')) {\n                  _context.next = 3;\n                  break;\n                }\n\n                return _context.abrupt(\"return\");\n\n              case 3:\n                _this.setState({\n                  image: IMAGE.thinking\n                });\n\n                response = [];\n                dialog = _this.state.dialog;\n                console.log('check script', scriptDeleteSpace);\n                _context.next = 9;\n                return axios.post('http://34.87.30.67:8080/chat', {\n                  message: final_script\n                }, {\n                  headers: {\n                    Authorization: \"Bearer \".concat(_this.state.user.accessToken)\n                  }\n                });\n\n              case 9:\n                res = _context.sent;\n                window.res = res;\n                console.log('check res', res);\n\n                finish = function finish() {\n                  dialog.push({\n                    response: response,\n                    question: final_script,\n                    index: dialog.length\n                  });\n\n                  _this.setState({\n                    image: IMAGE.normal,\n                    dialog: dialog,\n                    interim: null\n                  });\n                };\n\n                if (res.status === 200) {\n                  if (res.data.responseData.mentors) {\n                    response = [res.data.responseData.message].concat(_toConsumableArray(res.data.responseData.mentors.map(function (e) {\n                      return \"\".concat(e.name, \" (\").concat(e.address.address, \")\");\n                    })));\n                    finish();\n                  } else if (res.data.responseData.users) {\n                    response = [res.data.responseData.message].concat(_toConsumableArray(res.data.responseData.users.map(function (e) {\n                      return \"\".concat(e.name, \",\\u0111\\u1ECBa ch\\u1EC9 \\u1EDF \").concat(e.organization);\n                    })));\n                    finish();\n                  } else {\n                    response = [res.data.responseData.message];\n                  }\n                }\n\n                keys = Object.keys(FAQs);\n                i = 0;\n\n              case 16:\n                if (!(i < keys.length)) {\n                  _context.next = 25;\n                  break;\n                }\n\n                faq = FAQs[keys[i]];\n\n                if (!(FAQs[keys[i]].important.every(function (e) {\n                  return scriptDeleteSpace.indexOf(e) !== -1;\n                }) && FAQs[keys[i]].sub.some(function (e) {\n                  return scriptDeleteSpace.indexOf(e) !== -1;\n                }))) {\n                  _context.next = 22;\n                  break;\n                }\n\n                response = FAQs[keys[i]].responses;\n                finish();\n                return _context.abrupt(\"return\");\n\n              case 22:\n                i++;\n                _context.next = 16;\n                break;\n\n              case 25:\n                _i = 0;\n\n              case 26:\n                if (!(_i < WARNING.length)) {\n                  _context.next = 34;\n                  break;\n                }\n\n                if (!(scriptDeleteSpace.indexOf(WARNING[_i]) !== -1)) {\n                  _context.next = 31;\n                  break;\n                }\n\n                response = ['Bạn ăn nói cho cẩn thận , đá giờ'];\n                finish();\n                return _context.abrupt(\"return\");\n\n              case 31:\n                _i++;\n                _context.next = 26;\n                break;\n\n              case 34:\n                _i2 = 0;\n\n              case 35:\n                if (!(_i2 < TRIGGER_END.length)) {\n                  _context.next = 43;\n                  break;\n                }\n\n                if (!(scriptDeleteSpace.indexOf(TRIGGER_END[_i2]) !== -1)) {\n                  _context.next = 40;\n                  break;\n                }\n\n                response = ['Chảo bạn nhé !!'];\n                finish();\n                return _context.abrupt(\"return\");\n\n              case 40:\n                _i2++;\n                _context.next = 35;\n                break;\n\n              case 43:\n                finish();\n\n              case 44:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    _this.sendMessage = function (final_script) {\n      _this.processing(final_script);\n    };\n\n    _this.init = function () {\n      var user = localStorage.getItem('angelhack');\n\n      if (user) {\n        _this.setState({\n          user: JSON.parse(user)\n        });\n      }\n\n      _this.recognition = new SpeechRecognition(); //recognition.continuous = false;\n\n      _this.recognition.lang = 'vi-VN';\n      _this.recognition.interimResults = true;\n\n      _this.recognition.onstart = function (event) {\n        _this.setState({\n          image: IMAGE.hearing\n        });\n      };\n\n      _this.recognition.onresult = function (event) {\n        var final_transcript = '';\n        var interim_transcript = '';\n\n        if (typeof event.results == 'undefined') {\n          _this.recognition.onend = null;\n\n          _this.recognition.stop();\n\n          return;\n        }\n\n        for (var i = event.resultIndex; i < event.results.length; ++i) {\n          if (event.results[i].isFinal) {\n            console.log('check final', event.results[i][0].transcript);\n            final_transcript += event.results[i][0].transcript;\n\n            _this.processing(final_transcript);\n          } else {\n            interim_transcript += event.results[i][0].transcript;\n\n            _this.setState({\n              interim: interim_transcript\n            });\n          }\n        }\n\n        final_transcript = capitalize(final_transcript); // if (final_transcript || interim_transcript) {\n        //     showButtons('inline-block');\n        // }\n      };\n\n      _this.recognition.onend = function (event) {\n        _this.setState({\n          image: IMAGE.normal\n        });\n      }; // this.synsthesis = window.speechSynthesis\n      // this.utterThis = new SpeechSynthesisUtterance(\"Hi !! I'm a god. Can you please help me .... tell me what's the weather today? \")\n      // this.utterThis.pitch = Number(this.state.pitch)\n\n    };\n\n    _this.recognition = null;\n    _this.state = {\n      dialog: [],\n      interim: null,\n      image: IMAGE.normal,\n      user: null\n    };\n    return _this;\n  }\n\n  return BotContainer;\n}(Container);\nvar botContainer = new BotContainer();\nexport default botContainer;\nwindow.bot = botContainer;","map":{"version":3,"sources":["/media/caobo171/07190f2f-2f0f-48f2-bf9e-e2b5e9484259/project1/angelhack/vti-angelhack/client/src/containers/botContainer.js"],"names":["Container","axios","SpeechRecognition","window","webkitSpeechRecognition","SpeechSynthesis","SpeechSynthesisUtterance","capitalize","s","first_char","replace","m","toUpperCase","IMAGE","TRIGGER_END","WARNING","FAQs","important","sub","responses","BotContainer","props","processing","final_script","scriptDeleteSpace","toLocaleLowerCase","setState","image","thinking","response","dialog","state","console","log","post","message","headers","Authorization","user","accessToken","res","finish","push","question","index","length","normal","interim","status","data","responseData","mentors","map","e","name","address","users","organization","keys","Object","i","faq","every","indexOf","some","sendMessage","init","localStorage","getItem","JSON","parse","recognition","lang","interimResults","onstart","event","hearing","onresult","final_transcript","interim_transcript","results","onend","stop","resultIndex","isFinal","transcript","botContainer","bot"],"mappings":"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","sourcesContent":["import { Container } from 'unstated-x'\n\nimport axios from 'axios'\nconst SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition\nconst SpeechSynthesis = window.SpeechSynthesis\nconst SpeechSynthesisUtterance = window.SpeechSynthesisUtterance\n\n\n\nfunction capitalize(s) {\n    var first_char = /\\S/;\n    return s.replace(first_char, function (m) { return m.toUpperCase(); });\n}\n\nexport const IMAGE = {\n    'normal': 'https://i.imgur.com/ilmoJsC.png',\n    'hearing': 'https://i.imgur.com/uS0pZYx.png',\n    'thinking': 'https://i.imgur.com/y5Uc9mL.png'\n}\nconst TRIGGER_END = ['kếtthúc', 'thếthôi', 'hếtrồi', 'xongrồi']\nconst WARNING = ['màyngu', 'bạnngu']\n\n\nconst FAQs = {\n    \"luyện nghe\": {\n        important: [\"nghe\"],\n        sub: [\"cảithiện\", \"nângcao\", \"nâng\", \"luyện\"],\n        responses: [\n            \"Bạn có thể tham khảo những nguồn sau:\",\n            `https://nghetienganhpro.com/luyen-nghe-mat-goc-tieng-anh/`,\n            `https://ngocbach.com/category/thu-vien/listenting/`,\n            `https://www.welevn.com/`\n        ]\n    },\n    \"luyện nói\": {\n        important: [\"nói\"],\n        sub: [\"cảithiện\", \"nângcao\", \"nâng\", \"luyện\", \"thếcòn\"],\n        responses: [\n            \"Bạn đọc thử  nhé :\",\n            `https://www.youtube.com/user/proworkshop`,\n            `https://engbreaking.com/`,\n            'https://ngocbach.com/category/thu-vien/speaking-thu-vien/'\n        ]\n    },\n    \"luyện đọc\": {\n        important: [\"đọc\"],\n        sub: [\"cảithiện\", \"nângcao\", \"nâng\", \"luyện\", \"thếcòn\"],\n        responses: [\n            \"Bạn có thể tham khảo những nguồn sau:\",\n            `https://langmaster.edu.vn/10-website-giup-bnaj-luyen-ky-nang-doc-sieu-dang-a15i668.html`,\n            `https://x3english.com/cach-doc-tieng-anh`\n        ]\n    },\n    \"luyện viết\": {\n        important: [\"viết\"],\n        sub: [\"cảithiện\", \"nângcao\", \"nâng\", \"luyện\", \"thếcòn\"],\n        responses: [\n            \"Bạn có tham khảo mấy trang này nhé:\",\n            `https://ngocbach.com/category/thu-vien/writing-thu-vien/`,\n            `https://langmaster.edu.vn/12-loi-khuyen-dat-gia-cho-nguoi-bat-dau-luyen-viet-tieng-anh-a15i951.html`,\n            `https://jolo.edu.vn/vi/thu-vien/bi-quyet-ielts/luyen-viet-ielts-cho-nguoi-moi-bat-dau.html`\n\n        ]\n    },\n    \"tự học hay trung tâm\": {\n        important: [\"hay\", \"trungtâm\", \"tựhọc\"],\n        sub: [\"trungtâm\"],\n        responses: [\n            \"Theo mình thì tự học sẽ tốt hơn !!\",\n            \"Nhưng nếu bạn thấy không hợp và không chủ động được thì nên đi học Trung tâm :))) \"\n        ]\n    },\n    \"ơi\": {\n        important: [\"ơi\"],\n        sub: [\"bạn\", \"ơi\"],\n        responses: [\n            \"Ơi !!\"\n        ]\n    },\n    \"bắt đầu\": {\n        important: [\"bắtđầu\"],\n        sub: [\"từđâu\", \"thếnào\", \"ởđâu\"],\n        responses: [\n            \"Bạn có thể tham khảo những nguồn sau\",\n            `https://vnexpress.net/giao-duc/sau-loi-khuyen-hoc-tieng-anh-cho-tan-sinh-vien-3275824.html`,\n            `http://learningeffortlessenglish.com/huong-dan-hoc/307/huong-dan-hoc-effortless-english-ban-tieng-viet-.html`,\n            `https://engbreaking.com/`\n        ]\n    },\n    'trung bình': {\n        important: [\"học\"],\n        sub: [\"cũngđược\", \"bìnhthường\", \"khôngdốt\", \"tàmtạm\"],\n        responses: [\n            `Mình nghĩ bạn nên tham khảo các nguồn online`,\n            `Nếu không lên được thì hãy nghĩ đến nhưng trung tâm uy tín như:`,\n            `British Council, IELTS Workshop`\n        ]\n    },\n    'học': {\n        important: ['học'],\n        sub: [\"với\", \"thếnào\", \"đượckhông\", \"rasao\"],\n        responses: [\n            `Ừ ,bạn yên tâm, mình sẽ cố gắng hết sức !! Bạn hỏi tiếp đi !!`\n        ]\n    }\n\n}\n\n\nexport class BotContainer extends Container {\n    constructor(props) {\n        super(props)\n        this.recognition = null\n        this.state = {\n            dialog: [],\n            interim: null,\n            image: IMAGE.normal,\n            user: null\n        }\n    }\n\n\n    processing = async (final_script) => {\n\n        const scriptDeleteSpace = final_script.replace(/\\s/g, \"\").toLocaleLowerCase()\n        if (scriptDeleteSpace === '') return\n        this.setState({ image: IMAGE.thinking })\n        let response = []\n        let dialog = this.state.dialog\n        console.log('check script', scriptDeleteSpace)\n\n\n        const res = await axios.post('http://34.87.30.67:8080/chat', {\n            message: final_script\n        }, {\n                headers: {\n                    Authorization: `Bearer ${this.state.user.accessToken}`\n                }\n            })\n\n\n\n        window.res = res\n\n        console.log('check res', res)\n\n        const finish = () => {\n            dialog.push({\n                response,\n                question: final_script,\n                index: dialog.length\n            })\n\n            this.setState({\n                image: IMAGE.normal, dialog,\n                interim: null\n            })\n        }\n\n        if (res.status === 200) {\n            if (res.data.responseData.mentors) {\n                response = [\n                    res.data.responseData.message,\n                    ...res.data.responseData.mentors.map(e => `${e.name} (${e.address.address})`),\n\n                ]\n                finish()\n            } else if (res.data.responseData.users) {\n                response = [\n                    res.data.responseData.message,\n                    ...res.data.responseData.users.map(e => `${e.name},địa chỉ ở ${e.organization}`),\n\n                ]\n                finish()\n            }\n            else {\n                response = [\n                    res.data.responseData.message\n                ]\n            }\n\n        }\n\n        const keys = Object.keys(FAQs)\n        for (let i = 0; i < keys.length; i++) {\n            const faq = FAQs[keys[i]]\n            if (\n                FAQs[keys[i]].important.every(e =>\n                    scriptDeleteSpace.indexOf(e) !== -1\n                ) &&\n                FAQs[keys[i]].sub.some(e =>\n                    scriptDeleteSpace.indexOf(e) !== -1)) {\n                response = FAQs[keys[i]].responses\n                finish()\n                return\n            }\n        }\n\n        for (let i = 0; i < WARNING.length; i++) {\n            if (scriptDeleteSpace.indexOf(WARNING[i]) !== -1) {\n                response = ['Bạn ăn nói cho cẩn thận , đá giờ']\n                finish()\n                return\n            }\n        }\n\n        for (let i = 0; i < TRIGGER_END.length; i++) {\n            if (scriptDeleteSpace.indexOf(TRIGGER_END[i]) !== -1) {\n                response = ['Chảo bạn nhé !!']\n                finish()\n                return\n            }\n        }\n\n        finish()\n\n\n    }\n\n    sendMessage = (final_script) => {\n        this.processing(final_script)\n    }\n\n    init = () => {\n        const user = localStorage.getItem('angelhack')\n        if (user) {\n            this.setState({ user: JSON.parse(user) })\n        }\n        this.recognition = new SpeechRecognition();\n        //recognition.continuous = false;\n        this.recognition.lang = 'vi-VN';\n        this.recognition.interimResults = true;\n\n        this.recognition.onstart = (event) => {\n            this.setState({ image: IMAGE.hearing })\n        }\n        this.recognition.onresult = (event) => {\n            let final_transcript = '';\n            var interim_transcript = '';\n            if (typeof (event.results) == 'undefined') {\n                this.recognition.onend = null;\n                this.recognition.stop();\n                return;\n            }\n\n            for (var i = event.resultIndex; i < event.results.length; ++i) {\n\n                if (event.results[i].isFinal) {\n                    console.log('check final', event.results[i][0].transcript)\n                    final_transcript += event.results[i][0].transcript;\n                    this.processing(final_transcript)\n                } else {\n                    interim_transcript += event.results[i][0].transcript;\n\n                    this.setState({ interim: interim_transcript })\n                }\n            }\n\n            final_transcript = capitalize(final_transcript);\n\n\n\n            // if (final_transcript || interim_transcript) {\n            //     showButtons('inline-block');\n            // }\n\n        }\n\n        this.recognition.onend = (event) => {\n            this.setState({ image: IMAGE.normal })\n        }\n\n        // this.synsthesis = window.speechSynthesis\n        // this.utterThis = new SpeechSynthesisUtterance(\"Hi !! I'm a god. Can you please help me .... tell me what's the weather today? \")\n        // this.utterThis.pitch = Number(this.state.pitch)\n    }\n\n\n\n\n\n}\n\nconst botContainer = new BotContainer()\n\nexport default botContainer\nwindow.bot = botContainer"]},"metadata":{},"sourceType":"module"}